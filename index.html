<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Prepaid Order Converter with Thanks</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    textarea { width: 100%; height: 250px; font-size: 14px; }
    pre { background: #f0f0f0; padding: 10px; white-space: pre-wrap; font-size: 14px; }
    button { padding: 10px 15px; font-size: 14px; margin: 4px; cursor: pointer; }
  </style>
</head>
<body>

<h2>Prepaid Order on Dukaan Converter + Thanks</h2>

<textarea id="input" placeholder="Paste order details here"></textarea><br><br>

<button onclick="selectAll()">Select All</button>
<button onclick="clearText()">Clear</button>
<button onclick="convert()">Convert</button>
<button onclick="copyAll()">Copy All</button>
<button onclick="sendToCustomer()">Send to Customer WhatsApp</button>
<button onclick="sendToOwn()">Send to Own WhatsApp</button>
<button onclick="sendThanks()">Send Thanks</button>

<pre id="output"></pre>

<script>
function selectAll() {
  let input = document.getElementById("input");
  input.focus();
  input.select();
}

function clearText() {
  document.getElementById("input").value = "";
  document.getElementById("output").textContent = "";
}

function convert() {
  let input = document.getElementById("input").value;

  let orderMatch = input.match(/#\d{5,}/);
  let orderId = orderMatch ? orderMatch[0] : "Not found";

  let nameMatch = input.match(/Name\s*\n([^\n]+)/i);
  let name = nameMatch ? nameMatch[1].trim() : "Customer";

  let mobileMatch = input.match(/Mobile\s*\n([^\n]+)/i);
  let mobile = mobileMatch ? mobileMatch[1].trim() : "";

  let altMobileMatch = input.match(/Alternate Mobile Number\s*\n([^\n]+)/i);
  let altMobile = altMobileMatch ? altMobileMatch[1].trim() : "";

  let emailMatch = input.match(/Email\s*\n([^\n]+)/i);
  let email = emailMatch ? emailMatch[1].trim() : "";

  let addressMatch = input.match(/Shipping address\s*\n([^\n]+)/i);
  let address = addressMatch ? addressMatch[1].trim() : "";

  let pincodeMatch = input.match(/\b\d{6}\b/);
  let pincode = pincodeMatch ? pincodeMatch[0] : "";

  let stateMatch = input.match(/([A-Za-z\s]+)\s*\d{6}/);
  let state = stateMatch ? stateMatch[1].trim() : "";

  let productMatch = input.match(/GPZ M88 GAMESTICK/);
  let product = productMatch ? "M88" : "Unknown Product";

  let variant = "128GB"; // Default for M88

  let basePriceMatch = input.match(/1x\s*₹([\d,]+)/i);
  let basePrice = basePriceMatch ? `₹${basePriceMatch[1]}` : "N/A";

  let discountMatch = input.match(/Coupon discount.*-\₹(\d+)/i);
  let discount = discountMatch ? `₹${discountMatch[1]}` : "0";

  let paidMatch = input.match(/Total\s*PAID\s*₹([\d,]+)/i);
  let amountPaid = paidMatch ? `₹${paidMatch[1]}` : "N/A";

  let outputText = 
`🟢 Prepaid Order on Dukaan

Order ID: ${orderId}
Name: ${name}
Mobile: ${mobile}
Alt Mobile: ${altMobile}
Email: ${email}

Address: ${address}
Landmark: (Not provided)
Pincode: ${pincode}
State: ${state}
District/City: (to extract if needed)
Post office: (to extract if needed)

Product: ${product}
Variant: ${variant}
Base Price: ${basePrice}
Discount Applied: ${discount}
Amount Paid: ${amountPaid}`;

  document.getElementById("output").textContent = outputText;
}

function copyAll() {
  let output = document.getElementById("output").textContent;
  navigator.clipboard.writeText(output).then(() => {
    alert("Output copied to clipboard!");
  });
}

function sendToCustomer() {
  let input = document.getElementById("input").value;
  let mobileMatch = input.match(/\+91[-\s]?[0-9]{10}/);
  let mobile = mobileMatch ? mobileMatch[0].replace(/\s|-/g,"") : "";
  let msg = encodeURIComponent(document.getElementById("output").textContent);
  if(mobile) window.open(`https://wa.me/${mobile}?text=${msg}`, "_blank");
  else alert("Customer mobile number not found in input.");
}

function sendToOwn() {
  let msg = encodeURIComponent(document.getElementById("output").textContent);
  window.open(`https://wa.me/917983624797?text=${msg}`, "_blank");
}

function sendThanks() {
  let output = document.getElementById("output").textContent;

  let nameMatch = output.match(/Name: ([^\n]+)/);
  let name = nameMatch ? nameMatch[1] : "Customer";

  let orderMatch = output.match(/Order ID: ([^\n]+)/);
  let orderId = orderMatch ? orderMatch[1] : "Not found";

  let productMatch = output.match(/Product: ([^\n]+)/);
  let product = productMatch ? productMatch[1].trim() : "";

  let pincodeMatch = output.match(/Pincode: ([^\n]+)/);
  let pincode = pincodeMatch ? pincodeMatch[1] : "";

  let thanksMsg = encodeURIComponent(
`🌟 GamesPlanet
🙏 Hello ${name} ji, thank you for your order ${orderId}.
📦 Product: ${product}
📍 Pincode: ${pincode}
🚚 Your order will be shipped soon between 8PM–10PM.
🔗 Tracking will update on our website after dispatch.
🖼️ On request, we can share the parcel photo & tracking number here on WhatsApp.
💚 Team GamesPlanet`
  );

  let inputText = document.getElementById("input").value;
  let mobileMatchInput = inputText.match(/\+91[-\s]?[0-9]{10}/);
  let mobile = mobileMatchInput ? mobileMatchInput[0].replace(/\s|-/g,"") : "";
  if(mobile) window.open(`https://wa.me/${mobile}?text=${thanksMsg}`, "_blank");
  else alert("Customer mobile number not found in input.");
}
</script>

</body>
</html>
